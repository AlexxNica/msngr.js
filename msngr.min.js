var msngr=msngr||function(){"use strict";var internal={},external=function(topic,category,dataType){return internal.objects.message(topic,category,dataType)};return external.version="2.0.0",external.extend=function(obj,target){if(target=target||external,"[object Function]"===Object.prototype.toString.call(obj)&&(obj=obj.apply(this,[external,internal])),"[object Object]"===Object.prototype.toString.call(obj))for(var key in obj)obj.hasOwnProperty(key)&&("[object Object]"===Object.prototype.toString.call(obj[key])?(void 0===target[key]&&(target[key]={}),target[key]=external.extend(obj[key],target[key])):target[key]="[object Array]"===Object.prototype.toString.call(obj[key])?(target[key]||[]).concat(obj[key]):obj[key]);return target},Object.defineProperty(external,"debug",{set:function(value){value===!0?external.internal=internal:value===!1&&delete external.internal}}),external}();msngr.extend(function(external,internal){"use strict";return{argumentsToArray:function(args){return external.isArray(args)?args:external.isArguments(args)?Array.prototype.slice.call(args,0):[args]}}}),msngr.extend(function(external,internal){"use strict";return{isHtmlElement:function(obj){var t=this.getType(obj);return 0===t.indexOf("[object HTML")||0===t.indexOf("[object global]")},isNodeList:function(obj){return"[object NodeList]"===this.getType(obj)},findElement:function(element,root){var elms=external.findElements(element);return void 0!==elms&&elms.length>0?elms[0]:elms},findElements:function(selector,root){var elm;if(external.isHtmlElement(selector)&&(elm=selector),void 0===elm&&external.isString(selector)){var doc=root||document,result=doc.querySelectorAll(selector);null!==result&&(elm=result)}return elm},getDomPath:function(element){var node=external.isHtmlElement(element)?element:void 0;return void 0===node?void 0:(void 0===node.id&&(node.id=external.id()),"#"+node.id)},querySelectorAllWithEq:function(selector,root){if(void 0===selector)return null;for(var doc=root||document,queue=[],process=function(input){if(-1===input.indexOf(":eq("))return void 0;var eqlLoc=input.indexOf(":eq("),sel=input.substring(0,eqlLoc),ind=input.substring(eqlLoc+4,input.indexOf(")",eqlLoc));selector=input.substring(input.indexOf(")",eqlLoc)+1,input.length),">"===sel.charAt(0)&&(sel=sel.substring(1,sel.length)),">"===selector.charAt(0)&&(selector=selector.substring(1,selector.length)),queue.push({selector:sel,index:parseInt(ind,10)})};-1!==selector.indexOf(":eq");)process(selector);for(var result;queue.length>0;){var item=queue.shift();result=(result||doc).querySelectorAll(item.selector)[item.index]}return selector.trim().length>0?(result||doc).querySelectorAll(selector):[result]},querySelectorWithEq:function(selector){return external.querySelectorAllWithEq(selector)[0]}}}),msngr.extend(function(external,internal){"use strict";return internal.InvalidParametersException=function(str){return{name:"InvalidParametersException",severity:"unrecoverable",message:"Invalid parameters supplied to the {method} method".replace("{method}",str)}},internal.ReservedKeywordsException=function(keyword){return{name:"ReservedKeywordsException",severity:"unrecoverable",message:"Reserved keyword {keyword} supplied as action.".replace("{keyword}",keyword)}},{}}),msngr.extend(function(external,internal){"use strict";var nowPerformance=function(){return performance.now()},nowNode=function(){return process.hrtime()[1]/1e6},nowLegacy=function(){return(new Date).getTime()},nowExec=void 0,nowExecDebugLabel="",lastNow=void 0;return{id:function(){var d=external.now(),uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:3&r|8).toString(16)});return uuid},now:function(noDuplicate){void 0===nowExec&&("undefined"!=typeof performance?(nowExec=nowPerformance,nowExecDebugLabel="performance"):"undefined"!=typeof process?(nowExec=nowNode,nowExecDebugLabel="node"):(nowExec=nowLegacy,nowExecDebugLabel="legacy"));var now=nowExec();return noDuplicate===!0&&lastNow===now?external.now(noDuplicate):(lastNow=now,now)}}}),msngr.extend(function(external,internal){"use strict";return internal.reiterativeValidation=function(validationMethod,inputs){var result=!1;if(external.exist(validationMethod)&&external.exist(inputs)){external.isArray(inputs)||(inputs=[inputs]);for(var i=0;i<inputs.length&&(result=validationMethod.apply(this,[inputs[i]]),result!==!1);++i);}return result},{getType:function(obj){return external.exist(obj)?Object.prototype.toString.call(obj):""+obj},isArguments:function(obj){return"[object Arguments]"===external.getType(obj)},areArguments:function(){return internal.reiterativeValidation(external.isArguments,external.argumentsToArray(arguments))},isNullOrUndefined:function(obj){return void 0===obj||null===obj},exist:function(obj){return!external.isNullOrUndefined(obj)},exists:function(){return internal.reiterativeValidation(external.exist,external.argumentsToArray(arguments))},isString:function(str){return"[object String]"===external.getType(str)},areStrings:function(){return internal.reiterativeValidation(external.isString,external.argumentsToArray(arguments))},isDate:function(obj){return"[object Date]"===external.getType(obj)},areDates:function(){return internal.reiterativeValidation(external.isDate,external.argumentsToArray(arguments))},isArray:function(obj){return"[object Array]"===external.getType(obj)},areArrays:function(){return internal.reiterativeValidation(external.isArray,external.argumentsToArray(arguments))},isNumber:function(obj){return"[object Number]"===external.getType(obj)},areNumbers:function(){return internal.reiterativeValidation(external.isNumber,external.argumentsToArray(arguments))},isObject:function(obj){return"[object Object]"===external.getType(obj)},areObjects:function(){return internal.reiterativeValidation(external.isObject,external.argumentsToArray(arguments))},isFunction:function(func){return"[object Function]"===external.getType(func)},areFunctions:function(){return internal.reiterativeValidation(external.isFunction,external.argumentsToArray(arguments))},isEmptyString:function(str){var isStr=external.isString(str);return void 0===str||null===str||isStr&&0===str.toString().trim().length?!0:!1},areEmptyStrings:function(){return internal.reiterativeValidation(external.isEmptyString,external.argumentsToArray(arguments))},hasWildCard:function(str){return-1!==str.indexOf("*")}}}),msngr.extend(function(external,internal){"use strict";return internal.objects=internal.objects||{},internal.objects.executer=function(methods,payload,context){if(external.isFunction(methods)&&(methods=[methods]),!external.exist(methods)||!external.isArray(methods))throw internal.InvalidParametersException("executor");var exec=function(method,pay,ctx,done){setTimeout(function(){var async=!1,async=function(){return async=!0,function(result){done.apply(ctx,[result])}},syncResult=method.apply(ctx||this,[pay,async]);async!==!0&&done.apply(ctx,[syncResult])},0)};return{execute:function(done){return 0===methods.length&&external.exist(done)?done.apply(context,[[]]):exec(methods[0],payload,context,done)},parallel:function(done){var results=[],executed=0;if(0===methods.length&&external.exist(done))return done.apply(context,[[]]);for(var i=0;i<methods.length;++i)!function(m,p,c){exec(m,p,c,function(result){external.exist(result)&&results.push(result),++executed,executed===methods.length&&external.exist(done)&&done.apply(context,[results])})}(methods[i],payload,context)}}},{}}),msngr.extend(function(external,internal){"use strict";internal.objects=internal.objects||{};var handlers={},handlerCount=0;return Object.defineProperty(external,"handlerCount",{get:function(){return handlerCount}}),internal.reset=function(){handlers={},handlerCount=0,internal.store.clear()},internal.objects.message=function(topic,category,dataType){var msg=void 0;if(!external.exist(topic))throw internal.InvalidParametersException("msngr");if(!external.isObject(topic)&&!external.isString(topic))throw internal.InvalidParametersException("msngr");if(external.isEmptyString(topic))throw internal.InvalidParametersException("msngr");external.isObject(topic)?msg=topic:(msg={},msg.topic=topic,external.isEmptyString(category)||(msg.category=category),external.isEmptyString(dataType)||(msg.dataType=dataType));var msgObj={emit:function(payload,callback){var uuids=internal.store.query(msg);if(uuids.length>0){for(var methods=[],i=0;i<uuids.length;++i){var obj=handlers[uuids[i]];methods.push(obj.handler)}var execs=internal.objects.executer(methods,payload,msg.context||this);execs.parallel(callback)}return msgObj},persist:function(payload){},on:function(handler){var uuid=internal.store.index(msg);return handlers[uuid]={handler:handler,context:msg.context||this},handlerCount++,msgObj},bind:function(element,event){},drop:function(handler){var uuids=internal.store.query(msg);if(uuids.length>0)for(var i=0;i<uuids.length;++i){var uuid=uuids[i];handlers[uuid].handler===handler&&(delete handlers[uuid],handlerCount--,internal.store["delete"](uuid))}return msgObj},unbind:function(element,event){},dropAll:function(){var uuids=internal.store.query(msg);if(uuids.length>0)for(var i=0;i<uuids.length;++i){var uuid=uuids[i];delete handlers[uuid],handlerCount--,internal.store["delete"](uuid)}return msgObj}};return Object.defineProperty(msgObj,"message",{get:function(){return msg}}),msgObj},{}}),msngr.extend(function(external,internal){"use strict";var id_to_message={},direct_index={topic_to_id:{},topic_cat_to_id:{},topic_type_to_id:{},topic_cat_type_to_id:{}},index_count=0,deleteValueFromArray=function(arr,value){var inx=arr.indexOf(value),endIndex=arr.length-1;if(inx!==endIndex){var temp=arr[endIndex];arr[endIndex]=arr[inx],arr[inx]=temp}arr.pop()};return internal.store={index:function(message){if(external.exist(message)&&external.exist(message.topic)){var uuid=external.id();return id_to_message[uuid]=message,void 0===direct_index.topic_to_id[message.topic]&&(direct_index.topic_to_id[message.topic]=[]),direct_index.topic_to_id[message.topic].push(uuid),external.exist(message.category)&&(void 0===direct_index.topic_cat_to_id[message.topic]&&(direct_index.topic_cat_to_id[message.topic]={}),void 0===direct_index.topic_cat_to_id[message.topic][message.category]&&(direct_index.topic_cat_to_id[message.topic][message.category]=[]),direct_index.topic_cat_to_id[message.topic][message.category].push(uuid)),external.exist(message.dataType)&&(void 0===direct_index.topic_type_to_id[message.topic]&&(direct_index.topic_type_to_id[message.topic]={}),void 0===direct_index.topic_type_to_id[message.topic][message.dataType]&&(direct_index.topic_type_to_id[message.topic][message.dataType]=[]),direct_index.topic_type_to_id[message.topic][message.dataType].push(uuid)),external.exist(message.category)&&external.exist(message.dataType)&&(void 0===direct_index.topic_cat_type_to_id[message.topic]&&(direct_index.topic_cat_type_to_id[message.topic]={}),void 0===direct_index.topic_cat_type_to_id[message.topic][message.category]&&(direct_index.topic_cat_type_to_id[message.topic][message.category]={}),void 0===direct_index.topic_cat_type_to_id[message.topic][message.category][message.dataType]&&(direct_index.topic_cat_type_to_id[message.topic][message.category][message.dataType]=[]),direct_index.topic_cat_type_to_id[message.topic][message.category][message.dataType].push(uuid)),index_count++,uuid}return void 0},"delete":function(uuid){if(external.exist(uuid)&&external.exist(id_to_message[uuid])){var message=id_to_message[uuid];return external.exist(message.topic)&&(deleteValueFromArray(direct_index.topic_to_id[message.topic],uuid),external.exist(message.category)&&deleteValueFromArray(direct_index.topic_cat_to_id[message.topic][message.category],uuid),external.exist(message.dataType)&&deleteValueFromArray(direct_index.topic_type_to_id[message.topic][message.dataType],uuid),external.exist(message.category)&&external.exist(message.dataType)&&deleteValueFromArray(direct_index.topic_cat_type_to_id[message.topic][message.category][message.dataType],uuid)),delete id_to_message[uuid],index_count--,!0}return!1},query:function(message){if(external.exist(message)&&external.exist(message.topic)){if(!external.exist(message.category)&&!external.exist(message.dataType))return direct_index.topic_to_id[message.topic]||[];if(external.exist(message.category)&&!external.exist(message.dataType))return(direct_index.topic_cat_to_id[message.topic]||{})[message.category]||[];if(external.exist(message.dataType)&&!external.exist(message.category))return(direct_index.topic_type_to_id[message.topic]||{})[message.dataType]||[];if(external.exist(message.category)&&external.exist(message.dataType))return((direct_index.topic_cat_type_to_id[message.topic]||{})[message.category]||{})[message.dataType]||[]}return[]},clear:function(){return id_to_message={},direct_index={topic_to_id:{},topic_cat_to_id:{},topic_type_to_id:{},topic_cat_type_to_id:{}},index_count=0,!0},count:function(){return index_count}},{}}),msngr.extend(function(external,internal){"use strict";var InvalidParametersException=function(str){return{severity:"unrecoverable",message:"Invalid parameters supplied to the {method} method".replace("{method}",str)}},registerdPaths={},registerdEvents=0,listener=function(event){var node=this,path=external.getDomPath(node);return external.exist(registerdPaths[path])&&external.exist(registerdPaths[path][event.type])?msngr.emit(registerdPaths[path][event.type],event):msngr};return{bind:function(element,event,topic,category,dataType){if(!external.exist(element)||!external.exist(event)||!external.exist(topic))throw InvalidParametersException("bind");if(external.isObject(topic)&&!external.exist(topic.topic))throw InvalidParametersException("bind");var node=external.findElement(element),path=external.getDomPath(node);external.exist(registerdPaths[path])||(registerdPaths[path]={});var message=void 0;return external.isObject(topic)?message=topic:(message={},message.topic=topic,external.exist(category)&&(message.category=category),external.exist(dataType)&&(message.dataType=dataType)),registerdPaths[path][event]=message,node.addEventListener(event,listener),registerdEvents++,msngr},unbind:function(element,event){var node=external.findElement(element),path=external.getDomPath(node);return external.exist(registerdPaths[path])&&external.exist(registerdPaths[path][event])&&(node.removeEventListener(event,listener),delete registerdPaths[path][event],registerdEvents--),msngr},getBindCount:function(){return registerdEvents}}}),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=msngr);